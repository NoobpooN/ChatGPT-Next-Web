(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[510],{2067:e=>{"use strict";e.exports=require("node:async_hooks")},6195:e=>{"use strict";e.exports=require("node:buffer")},8607:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ComponentMod:()=>V,default:()=>z});var r={};n.r(r),n.d(r,{GET:()=>v,POST:()=>N,preferredRegion:()=>X,runtime:()=>I});var o={};n.r(o),n.d(o,{headerHooks:()=>G,originalPathname:()=>F,patchFetch:()=>K,requestAsyncStorage:()=>$,routeModule:()=>q,serverHooks:()=>D,staticGenerationAsyncStorage:()=>B,staticGenerationBailout:()=>W});var a=n(7875),i=n(8381),u=n(2251),s=n(9845),l=n(9579),c=n(7736),f=n(1480),d=n(572),h=n(5577);let p=Uint8Array,g=Uint32Array,w=Math.pow,y=new g(8),T=[],C=new g(64);function m(e){return(e-(0|e))*w(2,32)|0}let x=2,A=0;for(;A<64;){let e=!0;for(let t=2;t<=x/2;t++)x%t==0&&(e=!1);e&&(A<8&&(y[A]=m(w(x,.5))),T[A]=m(w(x,1/3)),A++),x++}let b=!!new p(new g([1]).buffer)[0];function S(e){return b?e>>>24|(e>>>16&255)<<8|(65280&e)<<8|e<<24:e}function k(e,t){return e>>>t|e<<32-t}function U(e){let t;let n=y.slice(),r=e.length,o=8*r,a=512-(o+64)%512-1+o+65,i=new p(a/8),u=new g(i.buffer);i.set(e,0),i[r]=128,u[u.length-1]=S(o);for(let e=0;e<a/32;e+=16){let r=n.slice();for(t=0;t<64;t++){let n;if(t<16)n=S(u[e+t]);else{let e=C[t-15],r=C[t-2];n=C[t-7]+C[t-16]+(k(e,7)^k(e,18)^e>>>3)+(k(r,17)^k(r,19)^r>>>10)}C[t]=n|=0;let o=(k(r[4],6)^k(r[4],11)^k(r[4],25))+(r[4]&r[5]^~r[4]&r[6])+r[7]+n+T[t],a=(k(r[0],2)^k(r[0],13)^k(r[0],22))+(r[0]&r[1]^r[2]&(r[0]^r[1]));for(let e=7;e>0;e--)r[e]=r[e-1];r[0]=o+a|0,r[4]=r[4]+o|0}for(t=0;t<8;t++)n[t]=n[t]+r[t]|0}return new p(new g(n.map(function(e){return S(e)})).buffer)}let _=new TextEncoder;function E(e){return e.reduce((e,t)=>{let n="00"+t.toString(16);return e+n.substring(n.length-2)},"")}function P(e){return E(U(_.encode(e)))}function R(e,t,n){let r=function(e,t){if(e.length>64&&(e=U(e)),e.length<64){let t=new Uint8Array(64);t.set(e,0),e=t}let n=new Uint8Array(64),r=new Uint8Array(64);for(let t=0;t<64;t++)n[t]=54^e[t],r[t]=92^e[t];let o=new Uint8Array(t.length+64);o.set(n,0),o.set(t,64);let a=new Uint8Array(96);return a.set(r,0),a.set(U(o),64),U(a)}("string"==typeof t?_.encode(t):t,"string"==typeof e?_.encode(e):e);return"hex"==n?E(r).toString():r}async function H(e,t,n){let r="hunyuan.tencentcloudapi.com",o="hunyuan",a="ChatCompletions",i=Math.floor(Date.now()/1e3),u=function(e){let t=new Date(1e3*e),n=t.getUTCFullYear(),r=("0"+(t.getUTCMonth()+1)).slice(-2),o=("0"+t.getUTCDate()).slice(-2);return`${n}-${r}-${o}`}(i),s=P(e),l="application/json",c=`content-type:${l}
host:`+r+"\nx-tc-action:"+a.toLowerCase()+"\n",f="content-type;host;x-tc-action",d=["POST","/","",c,f,s].join("\n"),h="TC3-HMAC-SHA256",p=P(d),g=u+"/"+o+"/tc3_request",w=R(u,"TC3"+n),y=R(o,w),T=R("tc3_request",y),C=R(h+"\n"+i+"\n"+g+"\n"+p,T,"hex");return{Authorization:h+" Credential="+t+"/"+g+", SignedHeaders="+f+", Signature="+C,"Content-Type":l,Host:r,"X-TC-Action":a,"X-TC-Timestamp":i.toString(),"X-TC-Version":"2023-09-01","X-TC-Region":""}}let O=(0,l.g)();async function M(e,{params:t}){if(console.log("[Tencent Route] params ",t),"OPTIONS"===e.method)return d.xk.json({body:"OK"},{status:200});let n=(0,h.I)(e,c.k8.Hunyuan);if(n.error)return d.xk.json(n,{status:401});try{return await j(e)}catch(e){return console.error("[Tencent] ",e),d.xk.json((0,f.B)(e))}}let v=M,N=M,I="edge",X=["arn1","bom1","cdg1","cle1","cpt1","dub1","fra1","gru1","hnd1","iad1","icn1","kix1","lhr1","pdx1","sfo1","sin1","syd1"];async function j(e){let t=new AbortController,n=O.tencentUrl||c.Mo;n.startsWith("http")||(n=`https://${n}`),n.endsWith("/")&&(n=n.slice(0,-1)),console.log("[Base Url]",n);let r=setTimeout(()=>{t.abort()},6e5),o=n,a=await e.text(),i={headers:await H(a,O.tencentSecretId,O.tencentSecretKey),method:e.method,body:a,redirect:"manual",duplex:"half",signal:t.signal};try{let e=await fetch(o,i),t=new Headers(e.headers);return t.delete("www-authenticate"),t.set("X-Accel-Buffering","no"),new Response(e.body,{status:e.status,statusText:e.statusText,headers:t})}finally{clearTimeout(r)}}let q=new i.AppRouteRouteModule({definition:{kind:u.x.APP_ROUTE,page:"/api/tencent/route",pathname:"/api/tencent",filename:"route",bundlePath:"app/api/tencent/route"},resolvedPagePath:"/Volumes/D/github/ChatGPT-Next-Web/app/api/tencent/route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:$,staticGenerationAsyncStorage:B,serverHooks:D,headerHooks:G,staticGenerationBailout:W}=q,F="/api/tencent/route";function K(){return(0,s.XH)({serverHooks:D,staticGenerationAsyncStorage:B})}let V=o,z=a.a.wrap(q)}},e=>{var t=t=>e(e.s=t);e.O(0,[297,45,276],()=>t(8607));var n=e.O();(_ENTRIES="undefined"==typeof _ENTRIES?{}:_ENTRIES)["middleware_app/api/tencent/route"]=n}]);
//# sourceMappingURL=route.js.map