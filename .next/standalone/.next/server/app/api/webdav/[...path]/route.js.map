{"version":3,"file":"app/api/webdav/[...path]/route.js","mappings":"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CAAAA,CAAAA,GAML,IAAMC,EAAY,CACvBC,SAAU,cACVC,UAAW,cACXC,gBAAiB,4BACjBC,OAAQ,YACV,EAEaC,EAAa,CACxBJ,SAAU,sBACVK,UAAW,0BACXC,SAAU,iCACVC,cAAe,WACjB,EAgDMC,EAAe,CACnB,gBACA,qBACA,qBACA,QACA,aACA,YACA,iBACA,cACA,sBACA,SACA,oBACA,uBACA,yBACA,qBACD,CAmBY9D,EAAiB,IACzB8D,EAAanF,GAAG,CAAC,GAAW,EAC7BuB,KAAAA,EACA6D,UAAW,GACXC,SAAU,CACRC,GAAI,SACJC,aAAc,SACdC,aAAc,QAChB,CACF,OACGL,EAAanF,GAAG,CAAC,GAAW,EAC7BuB,KAAAA,EACA6D,UAAW,GACXC,SAAU,CACRC,GAAI,QACJC,aAAc,QACdC,aAAc,OAChB,CACF,OACGC,CAnCH,iBACA,wBACA,0BACA,oBACD,CA+BiBzF,GAAG,CAAC,GAAW,EAC7BuB,KAAAA,EACA6D,UAAW,GACXC,SAAU,CACRC,GAAI,SACJC,aAAc,SACdC,aAAc,QAChB,CACF,OACGE,CArCH,qBACA,aACA,aACA,2BACA,yBACA,0BACA,6BACD,CA8BoB1F,GAAG,CAAC,GAAW,EAChCuB,KAAAA,EACA6D,UAAW,GACXC,SAAU,CACRC,GAAI,YACJC,aAAc,YACdC,aAAc,WAChB,CACF,IACD,CAMYtL,EAAiC,CAC5C,kCACA,2BACA,0BACA,kCACA,iCACA,8BACA,6BACA,4BACA,kCACD","sources":["webpack://_N_E/external commonjs \"node:async_hooks\"","webpack://_N_E/external commonjs \"node:buffer\"","webpack://_N_E/./app/api/webdav/[...path]/route.ts","webpack://_N_E/./app/api/webdav/[...path]/route.ts?edcf","webpack://_N_E/?fe73","webpack://_N_E/./app/config/server.ts","webpack://_N_E/./app/constant.ts","webpack://_N_E/<anon>"],"sourcesContent":["module.exports = require(\"node:async_hooks\");","module.exports = require(\"node:buffer\");","import { NextRequest, NextResponse } from \"next/server\";\nimport { STORAGE_KEY, internalAllowedWebDavEndpoints } from \"../../../constant\";\nimport { getServerSideConfig } from \"@/app/config/server\";\n\nconst config = getServerSideConfig();\n\nconst mergedAllowedWebDavEndpoints = [\n  ...internalAllowedWebDavEndpoints,\n  ...config.allowedWebDevEndpoints,\n].filter((domain) => Boolean(domain.trim()));\n\nconst normalizeUrl = (url: string) => {\n  try {\n    return new URL(url);\n  } catch (err) {\n    return null;\n  }\n};\n\nasync function handle(\n  req: NextRequest,\n  { params }: { params: { path: string[] } },\n) {\n  if (req.method === \"OPTIONS\") {\n    return NextResponse.json({ body: \"OK\" }, { status: 200 });\n  }\n  const folder = STORAGE_KEY;\n  const fileName = `${folder}/backup.json`;\n\n  const requestUrl = new URL(req.url);\n  let endpoint = requestUrl.searchParams.get(\"endpoint\");\n\n  // Validate the endpoint to prevent potential SSRF attacks\n  if (\n    !endpoint ||\n    !mergedAllowedWebDavEndpoints.some((allowedEndpoint) => {\n      const normalizedAllowedEndpoint = normalizeUrl(allowedEndpoint);\n      const normalizedEndpoint = normalizeUrl(endpoint as string);\n\n      return normalizedEndpoint &&\n        normalizedEndpoint.hostname === normalizedAllowedEndpoint?.hostname &&\n        normalizedEndpoint.pathname.startsWith(normalizedAllowedEndpoint.pathname);\n    })\n  ) {\n    return NextResponse.json(\n      {\n        error: true,\n        msg: \"Invalid endpoint\",\n      },\n      {\n        status: 400,\n      },\n    );\n  }\n\n  if (!endpoint?.endsWith(\"/\")) {\n    endpoint += \"/\";\n  }\n\n  const endpointPath = params.path.join(\"/\");\n  const targetPath = `${endpoint}${endpointPath}`;\n\n  // only allow MKCOL, GET, PUT\n  if (req.method !== \"MKCOL\" && req.method !== \"GET\" && req.method !== \"PUT\") {\n    return NextResponse.json(\n      {\n        error: true,\n        msg: \"you are not allowed to request \" + targetPath,\n      },\n      {\n        status: 403,\n      },\n    );\n  }\n\n  // for MKCOL request, only allow request ${folder}\n  if (req.method === \"MKCOL\" && !targetPath.endsWith(folder)) {\n    return NextResponse.json(\n      {\n        error: true,\n        msg: \"you are not allowed to request \" + targetPath,\n      },\n      {\n        status: 403,\n      },\n    );\n  }\n\n  // for GET request, only allow request ending with fileName\n  if (req.method === \"GET\" && !targetPath.endsWith(fileName)) {\n    return NextResponse.json(\n      {\n        error: true,\n        msg: \"you are not allowed to request \" + targetPath,\n      },\n      {\n        status: 403,\n      },\n    );\n  }\n\n  //   for PUT request, only allow request ending with fileName\n  if (req.method === \"PUT\" && !targetPath.endsWith(fileName)) {\n    return NextResponse.json(\n      {\n        error: true,\n        msg: \"you are not allowed to request \" + targetPath,\n      },\n      {\n        status: 403,\n      },\n    );\n  }\n\n  const targetUrl = targetPath;\n\n  const method = req.method;\n  const shouldNotHaveBody = [\"get\", \"head\"].includes(\n    method?.toLowerCase() ?? \"\",\n  );\n\n  const fetchOptions: RequestInit = {\n    headers: {\n      authorization: req.headers.get(\"authorization\") ?? \"\",\n    },\n    body: shouldNotHaveBody ? null : req.body,\n    redirect: \"manual\",\n    method,\n    // @ts-ignore\n    duplex: \"half\",\n  };\n\n  let fetchResult;\n\n  try {\n    fetchResult = await fetch(targetUrl, fetchOptions);\n  } finally {\n    console.log(\n      \"[Any Proxy]\",\n      targetUrl,\n      {\n        method: req.method,\n      },\n      {\n        status: fetchResult?.status,\n        statusText: fetchResult?.statusText,\n      },\n    );\n  }\n\n  return fetchResult;\n}\n\nexport const PUT = handle;\nexport const GET = handle;\nexport const OPTIONS = handle;\n\nexport const runtime = \"edge\";\n","import { AppRouteRouteModule } from \"next/dist/server/future/route-modules/app-route/module.compiled\";\nimport { RouteKind } from \"next/dist/server/future/route-kind\";\nimport { patchFetch as _patchFetch } from \"next/dist/server/lib/patch-fetch\";\nimport * as userland from \"/Volumes/D/github/ChatGPT-Next-Web/app/api/webdav/[...path]/route.ts\";\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new AppRouteRouteModule({\n    definition: {\n        kind: RouteKind.APP_ROUTE,\n        page: \"/api/webdav/[...path]/route\",\n        pathname: \"/api/webdav/[...path]\",\n        filename: \"route\",\n        bundlePath: \"app/api/webdav/[...path]/route\"\n    },\n    resolvedPagePath: \"/Volumes/D/github/ChatGPT-Next-Web/app/api/webdav/[...path]/route.ts\",\n    nextConfigOutput,\n    userland\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/webdav/[...path]/route\";\nfunction patchFetch() {\n    return _patchFetch({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\nexport { routeModule, requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout, originalPathname, patchFetch,  };\n\n//# sourceMappingURL=app-route.js.map","import { EdgeRouteModuleWrapper } from \"next/dist/server/web/edge-route-module-wrapper\";\n// Import the userland code.\nimport * as module from \"next-app-loader?name=app%2Fapi%2Fwebdav%2F%5B...path%5D%2Froute&page=%2Fapi%2Fwebdav%2F%5B...path%5D%2Froute&pagePath=private-next-app-dir%2Fapi%2Fwebdav%2F%5B...path%5D%2Froute.ts&appDir=%2FVolumes%2FD%2Fgithub%2FChatGPT-Next-Web%2Fapp&appPaths=%2Fapi%2Fwebdav%2F%5B...path%5D%2Froute&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!private-next-app-dir/api/webdav/[...path]/route.ts?__next_edge_ssr_entry__\";\nexport const ComponentMod = module;\nexport default EdgeRouteModuleWrapper.wrap(module.routeModule);\n\n//# sourceMappingURL=edge-app-route.js.map","import md5 from \"spark-md5\";\nimport { DEFAULT_MODELS } from \"../constant\";\n\ndeclare global {\n  namespace NodeJS {\n    interface ProcessEnv {\n      PROXY_URL?: string; // docker only\n\n      OPENAI_API_KEY?: string;\n      CODE?: string;\n\n      BASE_URL?: string;\n      OPENAI_ORG_ID?: string; // openai only\n\n      VERCEL?: string;\n      BUILD_MODE?: \"standalone\" | \"export\";\n      BUILD_APP?: string; // is building desktop app\n\n      HIDE_USER_API_KEY?: string; // disable user's api key input\n      DISABLE_GPT4?: string; // allow user to use gpt-4 or not\n      ENABLE_BALANCE_QUERY?: string; // allow user to query balance or not\n      DISABLE_FAST_LINK?: string; // disallow parse settings from url or not\n      CUSTOM_MODELS?: string; // to control custom models\n      DEFAULT_MODEL?: string; // to cnntrol default model in every new chat window\n\n      // azure only\n      AZURE_URL?: string; // https://{azure-url}/openai/deployments/{deploy-name}\n      AZURE_API_KEY?: string;\n      AZURE_API_VERSION?: string;\n\n      // google only\n      GOOGLE_API_KEY?: string;\n      GOOGLE_URL?: string;\n\n      // google tag manager\n      GTM_ID?: string;\n\n      // custom template for preprocessing user input\n      DEFAULT_INPUT_TEMPLATE?: string;\n    }\n  }\n}\n\nconst ACCESS_CODES = (function getAccessCodes(): Set<string> {\n  const code = process.env.CODE;\n\n  try {\n    const codes = (code?.split(\",\") ?? [])\n      .filter((v) => !!v)\n      .map((v) => md5.hash(v.trim()));\n    return new Set(codes);\n  } catch (e) {\n    return new Set();\n  }\n})();\n\nfunction getApiKey(keys?: string) {\n  const apiKeyEnvVar = keys ?? \"\";\n  const apiKeys = apiKeyEnvVar.split(\",\").map((v) => v.trim());\n  const randomIndex = Math.floor(Math.random() * apiKeys.length);\n  const apiKey = apiKeys[randomIndex];\n  if (apiKey) {\n    console.log(\n      `[Server Config] using ${randomIndex + 1} of ${\n        apiKeys.length\n      } api key - ${apiKey}`,\n    );\n  }\n\n  return apiKey;\n}\n\nexport const getServerSideConfig = () => {\n  if (typeof process === \"undefined\") {\n    throw Error(\n      \"[Server Config] you are importing a nodejs-only module outside of nodejs\",\n    );\n  }\n\n  const disableGPT4 = !!process.env.DISABLE_GPT4;\n  let customModels = process.env.CUSTOM_MODELS ?? \"\";\n  let defaultModel = process.env.DEFAULT_MODEL ?? \"\";\n\n  if (disableGPT4) {\n    if (customModels) customModels += \",\";\n    customModels += DEFAULT_MODELS.filter((m) => m.name.startsWith(\"gpt-4\"))\n      .map((m) => \"-\" + m.name)\n      .join(\",\");\n    if (defaultModel.startsWith(\"gpt-4\")) defaultModel = \"\";\n  }\n\n  const isAzure = !!process.env.AZURE_URL;\n  const isGoogle = !!process.env.GOOGLE_API_KEY;\n  const isAnthropic = !!process.env.ANTHROPIC_API_KEY;\n\n  // const apiKeyEnvVar = process.env.OPENAI_API_KEY ?? \"\";\n  // const apiKeys = apiKeyEnvVar.split(\",\").map((v) => v.trim());\n  // const randomIndex = Math.floor(Math.random() * apiKeys.length);\n  // const apiKey = apiKeys[randomIndex];\n  // console.log(\n  //   `[Server Config] using ${randomIndex + 1} of ${apiKeys.length} api key`,\n  // );\n\n  const allowedWebDevEndpoints = (\n    process.env.WHITE_WEBDEV_ENDPOINTS ?? \"\"\n  ).split(\",\");\n\n  return {\n    baseUrl: process.env.BASE_URL,\n    apiKey: getApiKey(process.env.OPENAI_API_KEY),\n    openaiOrgId: process.env.OPENAI_ORG_ID,\n\n    isAzure,\n    azureUrl: process.env.AZURE_URL,\n    azureApiKey: getApiKey(process.env.AZURE_API_KEY),\n    azureApiVersion: process.env.AZURE_API_VERSION,\n\n    isGoogle,\n    googleApiKey: getApiKey(process.env.GOOGLE_API_KEY),\n    googleUrl: process.env.GOOGLE_URL,\n\n    isAnthropic,\n    anthropicApiKey: getApiKey(process.env.ANTHROPIC_API_KEY),\n    anthropicApiVersion: process.env.ANTHROPIC_API_VERSION,\n    anthropicUrl: process.env.ANTHROPIC_URL,\n\n    gtmId: process.env.GTM_ID,\n\n    needCode: ACCESS_CODES.size > 0,\n    code: process.env.CODE,\n    codes: ACCESS_CODES,\n\n    proxyUrl: process.env.PROXY_URL,\n    isVercel: !!process.env.VERCEL,\n\n    hideUserApiKey: !!process.env.HIDE_USER_API_KEY,\n    disableGPT4,\n    hideBalanceQuery: !process.env.ENABLE_BALANCE_QUERY,\n    disableFastLink: !!process.env.DISABLE_FAST_LINK,\n    customModels,\n    defaultModel,\n    allowedWebDevEndpoints,\n  };\n};\n","export const OWNER = \"Yidadaa\";\nexport const REPO = \"ChatGPT-Next-Web\";\nexport const REPO_URL = `https://github.com/${OWNER}/${REPO}`;\nexport const ISSUE_URL = `https://github.com/${OWNER}/${REPO}/issues`;\nexport const UPDATE_URL = `${REPO_URL}#keep-updated`;\nexport const RELEASE_URL = `${REPO_URL}/releases`;\nexport const FETCH_COMMIT_URL = `https://api.github.com/repos/${OWNER}/${REPO}/commits?per_page=1`;\nexport const FETCH_TAG_URL = `https://api.github.com/repos/${OWNER}/${REPO}/tags?per_page=1`;\nexport const RUNTIME_CONFIG_DOM = \"danger-runtime-config\";\n\nexport const DEFAULT_API_HOST = \"https://api.nextchat.dev\";\nexport const OPENAI_BASE_URL = \"https://api.openai.com\";\nexport const ANTHROPIC_BASE_URL = \"https://api.anthropic.com\";\n\nexport const GEMINI_BASE_URL = \"https://generativelanguage.googleapis.com/\";\n\nexport enum Path {\n  Home = \"/\",\n  Chat = \"/chat\",\n  Settings = \"/settings\",\n  NewChat = \"/new-chat\",\n  Masks = \"/masks\",\n  Auth = \"/auth\",\n}\n\nexport enum ApiPath {\n  Cors = \"\",\n  Azure = \"/api/azure\",\n  OpenAI = \"/api/openai\",\n  Anthropic = \"/api/anthropic\",\n}\n\nexport enum SlotID {\n  AppBody = \"app-body\",\n  CustomModel = \"custom-model\",\n}\n\nexport enum FileName {\n  Masks = \"masks.json\",\n  Prompts = \"prompts.json\",\n}\n\nexport enum StoreKey {\n  Chat = \"chat-next-web-store\",\n  Access = \"access-control\",\n  Config = \"app-config\",\n  Mask = \"mask-store\",\n  Prompt = \"prompt-store\",\n  Update = \"chat-update\",\n  Sync = \"sync\",\n}\n\nexport const DEFAULT_SIDEBAR_WIDTH = 300;\nexport const MAX_SIDEBAR_WIDTH = 500;\nexport const MIN_SIDEBAR_WIDTH = 230;\nexport const NARROW_SIDEBAR_WIDTH = 100;\n\nexport const ACCESS_CODE_PREFIX = \"nk-\";\n\nexport const LAST_INPUT_KEY = \"last-input\";\nexport const UNFINISHED_INPUT = (id: string) => \"unfinished-input-\" + id;\n\nexport const STORAGE_KEY = \"chatgpt-next-web\";\n\nexport const REQUEST_TIMEOUT_MS = 60000;\n\nexport const EXPORT_MESSAGE_CLASS_NAME = \"export-markdown\";\n\nexport enum ServiceProvider {\n  OpenAI = \"OpenAI\",\n  Azure = \"Azure\",\n  Google = \"Google\",\n  Anthropic = \"Anthropic\",\n}\n\nexport enum ModelProvider {\n  GPT = \"GPT\",\n  GeminiPro = \"GeminiPro\",\n  Claude = \"Claude\",\n}\n\nexport const Anthropic = {\n  ChatPath: \"v1/messages\",\n  ChatPath1: \"v1/complete\",\n  ExampleEndpoint: \"https://api.anthropic.com\",\n  Vision: \"2023-06-01\",\n};\n\nexport const OpenaiPath = {\n  ChatPath: \"v1/chat/completions\",\n  UsagePath: \"dashboard/billing/usage\",\n  SubsPath: \"dashboard/billing/subscription\",\n  ListModelPath: \"v1/models\",\n};\n\nexport const Azure = {\n  ChatPath: (deployName: string, apiVersion: string) =>\n    `deployments/${deployName}/chat/completions?api-version=${apiVersion}`,\n  ExampleEndpoint: \"https://{resource-url}/openai/deployments/{deploy-id}\",\n};\n\nexport const Google = {\n  ExampleEndpoint: \"https://generativelanguage.googleapis.com/\",\n  ChatPath: (modelName: string) => `v1beta/models/${modelName}:generateContent`,\n};\n\nexport const DEFAULT_INPUT_TEMPLATE = `{{input}}`; // input / time / model / lang\n// export const DEFAULT_SYSTEM_TEMPLATE = `\n// You are ChatGPT, a large language model trained by {{ServiceProvider}}.\n// Knowledge cutoff: {{cutoff}}\n// Current model: {{model}}\n// Current time: {{time}}\n// Latex inline: $x^2$\n// Latex block: $$e=mc^2$$\n// `;\nexport const DEFAULT_SYSTEM_TEMPLATE = `\nYou are ChatGPT, a large language model trained by {{ServiceProvider}}.\nKnowledge cutoff: {{cutoff}}\nCurrent model: {{model}}\nCurrent time: {{time}}\nLatex inline: \\\\(x^2\\\\) \nLatex block: $$e=mc^2$$\n`;\n\nexport const SUMMARIZE_MODEL = \"gpt-3.5-turbo\";\nexport const GEMINI_SUMMARIZE_MODEL = \"gemini-pro\";\n\nexport const KnowledgeCutOffDate: Record<string, string> = {\n  default: \"2021-09\",\n  \"gpt-4-turbo\": \"2023-12\",\n  \"gpt-4-turbo-2024-04-09\": \"2023-12\",\n  \"gpt-4-turbo-preview\": \"2023-12\",\n  \"gpt-4o\": \"2023-10\",\n  \"gpt-4o-2024-05-13\": \"2023-10\",\n  \"gpt-4-vision-preview\": \"2023-04\",\n  // After improvements,\n  // it's now easier to add \"KnowledgeCutOffDate\" instead of stupid hardcoding it, as was done previously.\n  \"gemini-pro\": \"2023-12\",\n  \"gemini-pro-vision\": \"2023-12\",\n};\n\nconst openaiModels = [\n  \"gpt-3.5-turbo\",\n  \"gpt-3.5-turbo-1106\",\n  \"gpt-3.5-turbo-0125\",\n  \"gpt-4\",\n  \"gpt-4-0613\",\n  \"gpt-4-32k\",\n  \"gpt-4-32k-0613\",\n  \"gpt-4-turbo\",\n  \"gpt-4-turbo-preview\",\n  \"gpt-4o\",\n  \"gpt-4o-2024-05-13\",\n  \"gpt-4-vision-preview\",\n  \"gpt-4-turbo-2024-04-09\",\n  \"gpt-4-1106-preview\",\n];\n\nconst googleModels = [\n  \"gemini-1.0-pro\",\n  \"gemini-1.5-pro-latest\",\n  \"gemini-1.5-flash-latest\",\n  \"gemini-pro-vision\",\n];\n\nconst anthropicModels = [\n  \"claude-instant-1.2\",\n  \"claude-2.0\",\n  \"claude-2.1\",\n  \"claude-3-sonnet-20240229\",\n  \"claude-3-opus-20240229\",\n  \"claude-3-haiku-20240307\",\n  \"claude-3-5-sonnet-20240620\",\n];\n\nexport const DEFAULT_MODELS = [\n  ...openaiModels.map((name) => ({\n    name,\n    available: true,\n    provider: {\n      id: \"openai\",\n      providerName: \"OpenAI\",\n      providerType: \"openai\",\n    },\n  })),\n  ...openaiModels.map((name) => ({\n    name,\n    available: true,\n    provider: {\n      id: \"azure\",\n      providerName: \"Azure\",\n      providerType: \"azure\",\n    },\n  })),\n  ...googleModels.map((name) => ({\n    name,\n    available: true,\n    provider: {\n      id: \"google\",\n      providerName: \"Google\",\n      providerType: \"google\",\n    },\n  })),\n  ...anthropicModels.map((name) => ({\n    name,\n    available: true,\n    provider: {\n      id: \"anthropic\",\n      providerName: \"Anthropic\",\n      providerType: \"anthropic\",\n    },\n  })),\n] as const;\n\nexport const CHAT_PAGE_SIZE = 15;\nexport const MAX_RENDER_MSG_COUNT = 45;\n\n// some famous webdav endpoints\nexport const internalAllowedWebDavEndpoints = [\n  \"https://dav.jianguoyun.com/dav/\",\n  \"https://dav.dropdav.com/\",\n  \"https://dav.box.com/dav\",\n  \"https://nanao.teracloud.jp/dav/\",\n  \"https://bora.teracloud.jp/dav/\",\n  \"https://webdav.4shared.com/\",\n  \"https://dav.idrivesync.com\",\n  \"https://webdav.yandex.com\",\n  \"https://app.koofr.net/dav/Koofr\",\n];\n"],"names":["module","exports","require","config","getServerSideConfig","mergedAllowedWebDavEndpoints","internalAllowedWebDavEndpoints","allowedWebDevEndpoints","filter","Boolean","domain","trim","normalizeUrl","URL","url","err","handle","req","params","fetchResult","method","NextResponse","json","body","status","folder","STORAGE_KEY","fileName","endpoint","requestUrl","searchParams","get","some","normalizedAllowedEndpoint","allowedEndpoint","normalizedEndpoint","hostname","pathname","startsWith","error","msg","endsWith","endpointPath","path","join","targetPath","shouldNotHaveBody","includes","toLowerCase","fetchOptions","headers","authorization","redirect","duplex","fetch","console","log","statusText","PUT","GET","OPTIONS","runtime","routeModule","module_compiled","AppRouteRouteModule","definition","kind","route_kind","x","APP_ROUTE","page","filename","bundlePath","resolvedPagePath","nextConfigOutput","userland","route_namespaceObject","requestAsyncStorage","staticGenerationAsyncStorage","serverHooks","headerHooks","staticGenerationBailout","originalPathname","patchFetch","patch_fetch","XH","ComponentMod","route_next_edge_ssr_entry_namespaceObject","next_edge_app_route_loaderabsolutePagePath_private_next_app_dir_2Fapi_2Fwebdav_2F_5B_path_5D_2Froute_ts_page_2Fapi_2Fwebdav_2F_5B_path_5D_2Froute_appDirLoader_bmV4dC1hcHAtbG9hZGVyP25hbWU9YXBwJTJGYXBpJTJGd2ViZGF2JTJGJTVCLi4ucGF0aCU1RCUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGd2ViZGF2JTJGJTVCLi4ucGF0aCU1RCUyRnJvdXRlJnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGd2ViZGF2JTJGJTVCLi4ucGF0aCU1RCUyRnJvdXRlLnRzJmFwcERpcj0lMkZWb2x1bWVzJTJGRCUyRmdpdGh1YiUyRkNoYXRHUFQtTmV4dC1XZWIlMkZhcHAmYXBwUGF0aHM9JTJGYXBpJTJGd2ViZGF2JTJGJTVCLi4ucGF0aCU1RCUyRnJvdXRlJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PXN0YW5kYWxvbmUmcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCE_3D_nextConfigOutput_standalone_preferredRegion_middlewareConfig_e30_3D_","edge_route_module_wrapper","a","wrap","ACCESS_CODES","code","process","env","CODE","codes","split","v","map","md5","Set","e","getApiKey","keys","apiKeys","apiKeyEnvVar","randomIndex","Math","floor","random","length","apiKey","Error","disableGPT4","DISABLE_GPT4","customModels","CUSTOM_MODELS","defaultModel","DEFAULT_MODEL","DEFAULT_MODELS","m","name","isAzure","AZURE_URL","isGoogle","GOOGLE_API_KEY","isAnthropic","ANTHROPIC_API_KEY","WHITE_WEBDEV_ENDPOINTS","baseUrl","BASE_URL","OPENAI_API_KEY","openaiOrgId","OPENAI_ORG_ID","azureUrl","azureApiKey","AZURE_API_KEY","azureApiVersion","AZURE_API_VERSION","googleApiKey","googleUrl","GOOGLE_URL","anthropicApiKey","anthropicApiVersion","ANTHROPIC_API_VERSION","anthropicUrl","ANTHROPIC_URL","gtmId","GTM_ID","needCode","size","proxyUrl","PROXY_URL","isVercel","VERCEL","hideUserApiKey","HIDE_USER_API_KEY","hideBalanceQuery","ENABLE_BALANCE_QUERY","disableFastLink","DISABLE_FAST_LINK","OPENAI_BASE_URL","ANTHROPIC_BASE_URL","GEMINI_BASE_URL","Path","ApiPath","SlotID","FileName","StoreKey","ACCESS_CODE_PREFIX","ServiceProvider","ModelProvider","Anthropic","ChatPath","ChatPath1","ExampleEndpoint","Vision","OpenaiPath","UsagePath","SubsPath","ListModelPath","openaiModels","available","provider","id","providerName","providerType","googleModels","anthropicModels"],"sourceRoot":""}