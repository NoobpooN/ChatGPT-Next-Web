(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[162],{2067:e=>{"use strict";e.exports=require("node:async_hooks")},6195:e=>{"use strict";e.exports=require("node:buffer")},4051:(e,t,a)=>{"use strict";a.r(t),a.d(t,{ComponentMod:()=>b,default:()=>E});var o={};a.r(o),a.d(o,{GET:()=>h,OPTIONS:()=>c,POST:()=>l,runtime:()=>y});var s={};a.r(s),a.d(s,{headerHooks:()=>x,originalPathname:()=>w,patchFetch:()=>T,requestAsyncStorage:()=>f,routeModule:()=>k,serverHooks:()=>m,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>P});var n=a(7875),r=a(8381),u=a(2251),i=a(9845),d=a(572);async function p(e,{params:t}){let a=new URL(e.url).searchParams.get("endpoint");if("OPTIONS"===e.method)return d.xk.json({body:"OK"},{status:200});let[...o]=t.key;if(!a||!new URL(a).hostname.endsWith(".upstash.io"))return d.xk.json({error:!0,msg:"you are not allowed to request "+t.key.join("/")},{status:403});if("get"!==t.action&&"set"!==t.action)return console.log("[Upstash Route] forbidden action ",t.action),d.xk.json({error:!0,msg:"you are not allowed to request "+t.action},{status:403});let s=`${a}/${t.action}/${t.key.join("/")}`,n=e.method,r=["get","head"].includes(n?.toLowerCase()??""),u={headers:{authorization:e.headers.get("authorization")??""},body:r?null:e.body,method:n,duplex:"half"};console.log("[Upstash Proxy]",s,u);let i=await fetch(s,u);return console.log("[Any Proxy]",s,{status:i.status,statusText:i.statusText}),i}let l=p,h=p,c=p,y="edge",k=new r.AppRouteRouteModule({definition:{kind:u.x.APP_ROUTE,page:"/api/upstash/[action]/[...key]/route",pathname:"/api/upstash/[action]/[...key]",filename:"route",bundlePath:"app/api/upstash/[action]/[...key]/route"},resolvedPagePath:"/Volumes/D/github/ChatGPT-Next-Web/app/api/upstash/[action]/[...key]/route.ts",nextConfigOutput:"standalone",userland:o}),{requestAsyncStorage:f,staticGenerationAsyncStorage:g,serverHooks:m,headerHooks:x,staticGenerationBailout:P}=k,w="/api/upstash/[action]/[...key]/route";function T(){return(0,i.XH)({serverHooks:m,staticGenerationAsyncStorage:g})}let b=s,E=n.a.wrap(k)}},e=>{var t=t=>e(e.s=t);e.O(0,[297],()=>t(4051));var a=e.O();(_ENTRIES="undefined"==typeof _ENTRIES?{}:_ENTRIES)["middleware_app/api/upstash/[action]/[...key]/route"]=a}]);
//# sourceMappingURL=route.js.map