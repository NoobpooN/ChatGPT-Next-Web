(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[89],{2067:e=>{"use strict";e.exports=require("node:async_hooks")},6195:e=>{"use strict";e.exports=require("node:buffer")},7777:(e,t,a)=>{"use strict";a.r(t),a.d(t,{ComponentMod:()=>w,default:()=>b});var r={};a.r(r),a.d(r,{GET:()=>m,POST:()=>f,runtime:()=>T});var s={};a.r(s),a.d(s,{headerHooks:()=>y,originalPathname:()=>P,patchFetch:()=>_,requestAsyncStorage:()=>k,routeModule:()=>g,serverHooks:()=>x,staticGenerationAsyncStorage:()=>v,staticGenerationBailout:()=>E});var o=a(7875),n=a(8381),u=a(2251),i=a(9845),c=a(5045),d=a.n(c),l=a(572),p=a(9579);async function h(e,t){let a=(0,p.g)(),r=()=>`https://api.cloudflare.com/client/v4/accounts/${a.cloudflareAccountId}/storage/kv/namespaces/${a.cloudflareKVNamespaceId}`,s=()=>({Authorization:`Bearer ${a.cloudflareKVApiKey}`});if("POST"===e.method){let t=await e.text(),o=d().hash(t).trim(),n={key:o,value:t};try{let e=parseInt(a.cloudflareKVTTL);e>60&&(n.expiration_ttl=e)}catch(e){console.error(e)}let u=await fetch(`${r()}/bulk`,{headers:{...s(),"Content-Type":"application/json"},method:"PUT",body:JSON.stringify([n])}),i=await u.json();return(console.log("save data",i),i?.success)?l.xk.json({code:0,id:o,result:i},{status:u.status}):l.xk.json({error:!0,msg:"Save data error"},{status:400})}if("GET"===e.method){let t=e?.nextUrl?.searchParams?.get("id"),a=await fetch(`${r()}/values/${t}`,{headers:s(),method:"GET"});return new Response(a.body,{status:a.status,statusText:a.statusText,headers:a.headers})}return l.xk.json({error:!0,msg:"Invalid request"},{status:400})}let f=h,m=h,T="edge",g=new n.AppRouteRouteModule({definition:{kind:u.x.APP_ROUTE,page:"/api/artifacts/route",pathname:"/api/artifacts",filename:"route",bundlePath:"app/api/artifacts/route"},resolvedPagePath:"/Volumes/D/github/ChatGPT-Next-Web/app/api/artifacts/route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:k,staticGenerationAsyncStorage:v,serverHooks:x,headerHooks:y,staticGenerationBailout:E}=g,P="/api/artifacts/route";function _(){return(0,i.XH)({serverHooks:x,staticGenerationAsyncStorage:v})}let w=s,b=o.a.wrap(g)}},e=>{var t=t=>e(e.s=t);e.O(0,[297,45,579],()=>t(7777));var a=e.O();(_ENTRIES="undefined"==typeof _ENTRIES?{}:_ENTRIES)["middleware_app/api/artifacts/route"]=a}]);
//# sourceMappingURL=route.js.map